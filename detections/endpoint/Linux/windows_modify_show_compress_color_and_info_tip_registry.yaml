name: Windows Modify Show Compress Color And Info Tip Registry
id: windows-modify-registry-showcompcolor-infotip-001
version: 1
schema_version: "1.0"
date: "2026-02-27"
author: SOCFortress LLC
status: production
type: TTP

description: >
  Detects modifications to ShowCompColor and ShowInfoTip registry values under 
  Explorer\Advanced path. Hermetic Wiper malware modifies these to alter file 
  compression color display and information tips, manipulating file visibility 
  and deceiving users during destructive operations.

data_source:
  - Sysmon EventID 13

search:
  index_pattern: "${INDEX_PATTERN}"
  size: 100
  sort:
    - timestamp: desc
  query:
    bool:
      must:
        - term:
            agent_name: "${AGENT_NAME}"
        - term:
            agent_labels_customer: "${CUSTOMER_CODE}"
        - term:
            data_win_system_eventID: "13"
        - wildcard:
            data_win_eventdata_targetObject: "*\\Explorer\\Advanced*"
        - bool:
            should:
              - wildcard:
                  data_win_eventdata_targetObject: "*ShowCompColor*"
              - wildcard:
                  data_win_eventdata_targetObject: "*ShowInfoTip*"
            minimum_should_match: 1
        - range:
            timestamp:
              gte: "${START_TIME}"
              lte: "${END_TIME}"
  _source:
    - timestamp
    - agent_name
    - data_win_eventdata_targetObject
    - data_win_eventdata_details
    - data_win_eventdata_image
    - data_win_eventdata_user

parameters:
  AGENT_NAME:
    type: string
    required: true
  CUSTOMER_CODE:
    type: string
    required: true
  START_TIME:
    type: datetime
    default: "now-24h"
  END_TIME:
    type: datetime
    default: "now"

how_to_implement: >
  Requires Sysmon EventID 13 monitoring Explorer\Advanced registry paths.

known_false_positives: >
  Unknown. These settings are rarely modified manually.

references:
  - https://blog.talosintelligence.com/2022/02/threat-advisory-hermeticwiper.html

response:
  message: >
    ShowCompColor/ShowInfoTip modified on $agent_name$. 
    Registry: $data_win_eventdata_targetObject$. 
    Process: $data_win_eventdata_image$. 
    Possible Hermetic Wiper. MITRE ATT&CK: T1112
  risk_score: 25
  severity: low
  risk_objects:
    - field: agent_name
      type: system
      score: 25

tags:
  analytic_story:
    - Hermetic Wiper
    - Data Destruction
    - Windows Registry Abuse
  asset_type: Endpoint
  mitre_attack_id:
    - T1112
  custom_tags:
    - hermetic_wiper
    - explorer_advanced
    - file_visibility
  product:
    - Wazuh
  security_domain: endpoint
